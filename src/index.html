<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<title>Chat</title>
		<link href="/static/bootstrap.min.css" rel="stylesheet" />
		<!-- <link href="/static/tailwind.min.css" rel="stylesheet" /> -->
	</head>

	<body>
		<div className="container">
			<div className="row">
				<div className="col-2">
					<div id="chatList"></div>
				</div>
				<div className="col">
					<div id="chatView"></div>
				</div>
			</div>
		</div>
		<script>
			const client = new chat.ChatClient({
				httpUrl: 'https://chat.habin.io/query',
				wsUrl: 'wss://chat.habin.io/query',
				// httpUrl: 'http://localhost:8080/query',
				// wsUrl: 'ws://localhost:8080/query',
				token: '1',
			})

			;(async () => {
				// const chats = await client.getChats()
				// console.log(chats)
			})()

			async function loadChatList() {
				const $list = document.querySelector('#chatList')
				$list.innerHTML = 'Loading...'
				const chats = await client.getChats()
				$list.innerHTML = ''
				chats.forEach((chat) => {
					$list.innerHTML += `
					<div>
						<strong>${chat.name}</strong><br>
						${chat.lastMessage} ${chat.lastPostedAt}
					</div>`
				})
			}

			loadChatList()
		</script>
	</body>
</html>
